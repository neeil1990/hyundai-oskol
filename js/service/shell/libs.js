!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.PerfectScrollbar=e()}(this,function(){"use strict";function t(t){return getComputedStyle(t)}function e(t,e){for(var n in e){var i=e[n];"number"==typeof i&&(i+="px"),t.style[n]=i}return t}function n(t){var e=document.createElement("div");return e.className=t,e}function i(t,e){if(!m)throw new Error("No element matching method supported");return m.call(t,e)}function r(t){t.remove?t.remove():t.parentNode&&t.parentNode.removeChild(t)}function o(t,e){return Array.prototype.filter.call(t.children,function(t){return i(t,e)})}function s(t,e){var n=t.element.classList,i=b.state.scrolling(e);n.contains(i)?clearTimeout(y[e]):n.add(i)}function l(t,e){y[e]=setTimeout(function(){return t.isAlive&&t.element.classList.remove(b.state.scrolling(e))},t.settings.scrollingThreshold)}function a(t,e){s(t,e),l(t,e)}function c(t){if("function"==typeof window.CustomEvent)return new CustomEvent(t);var e=document.createEvent("CustomEvent");return e.initCustomEvent(t,!1,!1,void 0),e}function u(t,e,n,i,r){var o=n[0],s=n[1],l=n[2],u=n[3],p=n[4],d=n[5];void 0===i&&(i=!0),void 0===r&&(r=!1);var h=t.element;t.reach[u]=null,h[l]<1&&(t.reach[u]="start"),h[l]>t[o]-t[s]-1&&(t.reach[u]="end"),e&&(h.dispatchEvent(c("ps-scroll-"+u)),e<0?h.dispatchEvent(c("ps-scroll-"+p)):e>0&&h.dispatchEvent(c("ps-scroll-"+d)),i&&a(t,u)),t.reach[u]&&(e||r)&&h.dispatchEvent(c("ps-"+u+"-reach-"+t.reach[u]))}function p(t){return parseInt(t,10)||0}function d(t){return i(t,"input,[contenteditable]")||i(t,"select,[contenteditable]")||i(t,"textarea,[contenteditable]")||i(t,"button,[contenteditable]")}function h(e){var n=t(e);return p(n.width)+p(n.paddingLeft)+p(n.paddingRight)+p(n.borderLeftWidth)+p(n.borderRightWidth)}function f(t,e){return t.settings.minScrollbarLength&&(e=Math.max(e,t.settings.minScrollbarLength)),t.settings.maxScrollbarLength&&(e=Math.min(e,t.settings.maxScrollbarLength)),e}function g(t,n){var i={width:n.railXWidth};n.isRtl?i.left=n.negativeScrollAdjustment+t.scrollLeft+n.containerWidth-n.contentWidth:i.left=t.scrollLeft,n.isScrollbarXUsingBottom?i.bottom=n.scrollbarXBottom-t.scrollTop:i.top=n.scrollbarXTop+t.scrollTop,e(n.scrollbarXRail,i);var r={top:t.scrollTop,height:n.railYHeight};n.isScrollbarYUsingRight?n.isRtl?r.right=n.contentWidth-(n.negativeScrollAdjustment+t.scrollLeft)-n.scrollbarYRight-n.scrollbarYOuterWidth:r.right=n.scrollbarYRight-t.scrollLeft:n.isRtl?r.left=n.negativeScrollAdjustment+t.scrollLeft+2*n.containerWidth-n.contentWidth-n.scrollbarYLeft-n.scrollbarYOuterWidth:r.left=n.scrollbarYLeft+t.scrollLeft,e(n.scrollbarYRail,r),e(n.scrollbarX,{left:n.scrollbarXLeft,width:n.scrollbarXWidth-n.railBorderXWidth}),e(n.scrollbarY,{top:n.scrollbarYTop,height:n.scrollbarYHeight-n.railBorderYWidth})}function v(t,e){function n(e){f[d]=g+m*(e[a]-v),s(t,h),x(t),e.stopPropagation(),e.preventDefault()}function i(){l(t,h),t.event.unbind(t.ownerDocument,"mousemove",n)}var r=e[0],o=e[1],a=e[2],c=e[3],u=e[4],p=e[5],d=e[6],h=e[7],f=t.element,g=null,v=null,m=null;t.event.bind(t[u],"mousedown",function(e){g=f[d],v=e[a],m=(t[o]-t[r])/(t[c]-t[p]),t.event.bind(t.ownerDocument,"mousemove",n),t.event.once(t.ownerDocument,"mouseup",i),e.stopPropagation(),e.preventDefault()})}var m="undefined"!=typeof Element&&(Element.prototype.matches||Element.prototype.webkitMatchesSelector||Element.prototype.msMatchesSelector),b={main:"ps",element:{thumb:function(t){return"ps__thumb-"+t},rail:function(t){return"ps__rail-"+t},consuming:"ps__child--consume"},state:{focus:"ps--focus",active:function(t){return"ps--active-"+t},scrolling:function(t){return"ps--scrolling-"+t}}},y={x:null,y:null},w=function(t){this.element=t,this.handlers={}},O={isEmpty:{configurable:!0}};w.prototype.bind=function(t,e){void 0===this.handlers[t]&&(this.handlers[t]=[]),this.handlers[t].push(e),this.element.addEventListener(t,e,!1)},w.prototype.unbind=function(t,e){var n=this;this.handlers[t]=this.handlers[t].filter(function(i){return!(!e||i===e)||(n.element.removeEventListener(t,i,!1),!1)})},w.prototype.unbindAll=function(){var t=this;for(var e in t.handlers)t.unbind(e)},O.isEmpty.get=function(){var t=this;return Object.keys(this.handlers).every(function(e){return 0===t.handlers[e].length})},Object.defineProperties(w.prototype,O);var C=function(){this.eventElements=[]};C.prototype.eventElement=function(t){var e=this.eventElements.filter(function(e){return e.element===t})[0];return e||(e=new w(t),this.eventElements.push(e)),e},C.prototype.bind=function(t,e,n){this.eventElement(t).bind(e,n)},C.prototype.unbind=function(t,e,n){var i=this.eventElement(t);i.unbind(e,n),i.isEmpty&&this.eventElements.splice(this.eventElements.indexOf(i),1)},C.prototype.unbindAll=function(){this.eventElements.forEach(function(t){return t.unbindAll()}),this.eventElements=[]},C.prototype.once=function(t,e,n){var i=this.eventElement(t),r=function(t){i.unbind(e,r),n(t)};i.bind(e,r)};var $=function(t,e,n,i,r){void 0===i&&(i=!0),void 0===r&&(r=!1);var o;if("top"===e)o=["contentHeight","containerHeight","scrollTop","y","up","down"];else{if("left"!==e)throw new Error("A proper axis should be provided");o=["contentWidth","containerWidth","scrollLeft","x","left","right"]}u(t,n,o,i,r)},S={isWebKit:"undefined"!=typeof document&&"WebkitAppearance"in document.documentElement.style,supportsTouch:"undefined"!=typeof window&&("ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch),supportsIePointer:"undefined"!=typeof navigator&&navigator.msMaxTouchPoints,isChrome:"undefined"!=typeof navigator&&/Chrome/i.test(navigator&&navigator.userAgent)},x=function(t){var e=t.element;t.containerWidth=e.clientWidth,t.containerHeight=e.clientHeight,t.contentWidth=e.scrollWidth,t.contentHeight=e.scrollHeight,e.contains(t.scrollbarXRail)||(o(e,b.element.rail("x")).forEach(function(t){return r(t)}),e.appendChild(t.scrollbarXRail)),e.contains(t.scrollbarYRail)||(o(e,b.element.rail("y")).forEach(function(t){return r(t)}),e.appendChild(t.scrollbarYRail)),!t.settings.suppressScrollX&&t.containerWidth+t.settings.scrollXMarginOffset<t.contentWidth?(t.scrollbarXActive=!0,t.railXWidth=t.containerWidth-t.railXMarginWidth,t.railXRatio=t.containerWidth/t.railXWidth,t.scrollbarXWidth=f(t,p(t.railXWidth*t.containerWidth/t.contentWidth)),t.scrollbarXLeft=p((t.negativeScrollAdjustment+e.scrollLeft)*(t.railXWidth-t.scrollbarXWidth)/(t.contentWidth-t.containerWidth))):t.scrollbarXActive=!1,!t.settings.suppressScrollY&&t.containerHeight+t.settings.scrollYMarginOffset<t.contentHeight?(t.scrollbarYActive=!0,t.railYHeight=t.containerHeight-t.railYMarginHeight,t.railYRatio=t.containerHeight/t.railYHeight,t.scrollbarYHeight=f(t,p(t.railYHeight*t.containerHeight/t.contentHeight)),t.scrollbarYTop=p(e.scrollTop*(t.railYHeight-t.scrollbarYHeight)/(t.contentHeight-t.containerHeight))):t.scrollbarYActive=!1,t.scrollbarXLeft>=t.railXWidth-t.scrollbarXWidth&&(t.scrollbarXLeft=t.railXWidth-t.scrollbarXWidth),t.scrollbarYTop>=t.railYHeight-t.scrollbarYHeight&&(t.scrollbarYTop=t.railYHeight-t.scrollbarYHeight),g(e,t),t.scrollbarXActive?e.classList.add(b.state.active("x")):(e.classList.remove(b.state.active("x")),t.scrollbarXWidth=0,t.scrollbarXLeft=0,e.scrollLeft=0),t.scrollbarYActive?e.classList.add(b.state.active("y")):(e.classList.remove(b.state.active("y")),t.scrollbarYHeight=0,t.scrollbarYTop=0,e.scrollTop=0)},I={"click-rail":function(t){t.event.bind(t.scrollbarY,"mousedown",function(t){return t.stopPropagation()}),t.event.bind(t.scrollbarYRail,"mousedown",function(e){var n=e.pageY-window.pageYOffset-t.scrollbarYRail.getBoundingClientRect().top>t.scrollbarYTop?1:-1;t.element.scrollTop+=n*t.containerHeight,x(t),e.stopPropagation()}),t.event.bind(t.scrollbarX,"mousedown",function(t){return t.stopPropagation()}),t.event.bind(t.scrollbarXRail,"mousedown",function(e){var n=e.pageX-window.pageXOffset-t.scrollbarXRail.getBoundingClientRect().left>t.scrollbarXLeft?1:-1;t.element.scrollLeft+=n*t.containerWidth,x(t),e.stopPropagation()})},"drag-thumb":function(t){v(t,["containerWidth","contentWidth","pageX","railXWidth","scrollbarX","scrollbarXWidth","scrollLeft","x"]),v(t,["containerHeight","contentHeight","pageY","railYHeight","scrollbarY","scrollbarYHeight","scrollTop","y"])},keyboard:function(t){function e(e,i){var r=n.scrollTop;if(0===e){if(!t.scrollbarYActive)return!1;if(0===r&&i>0||r>=t.contentHeight-t.containerHeight&&i<0)return!t.settings.wheelPropagation}var o=n.scrollLeft;if(0===i){if(!t.scrollbarXActive)return!1;if(0===o&&e<0||o>=t.contentWidth-t.containerWidth&&e>0)return!t.settings.wheelPropagation}return!0}var n=t.element,r=function(){return i(n,":hover")},o=function(){return i(t.scrollbarX,":focus")||i(t.scrollbarY,":focus")};t.event.bind(t.ownerDocument,"keydown",function(i){if(!(i.isDefaultPrevented&&i.isDefaultPrevented()||i.defaultPrevented)&&(r()||o())){var s=document.activeElement?document.activeElement:t.ownerDocument.activeElement;if(s){if("IFRAME"===s.tagName)s=s.contentDocument.activeElement;else for(;s.shadowRoot;)s=s.shadowRoot.activeElement;if(d(s))return}var l=0,a=0;switch(i.which){case 37:l=i.metaKey?-t.contentWidth:i.altKey?-t.containerWidth:-30;break;case 38:a=i.metaKey?t.contentHeight:i.altKey?t.containerHeight:30;break;case 39:l=i.metaKey?t.contentWidth:i.altKey?t.containerWidth:30;break;case 40:a=i.metaKey?-t.contentHeight:i.altKey?-t.containerHeight:-30;break;case 32:a=i.shiftKey?t.containerHeight:-t.containerHeight;break;case 33:a=t.containerHeight;break;case 34:a=-t.containerHeight;break;case 36:a=t.contentHeight;break;case 35:a=-t.contentHeight;break;default:return}t.settings.suppressScrollX&&0!==l||t.settings.suppressScrollY&&0!==a||(n.scrollTop-=a,n.scrollLeft+=l,x(t),e(l,a)&&i.preventDefault())}})},wheel:function(e){function n(t,n){var i=0===s.scrollTop,r=s.scrollTop+s.offsetHeight===s.scrollHeight,o=0===s.scrollLeft,l=s.scrollLeft+s.offsetWidth===s.offsetWidth;return!(Math.abs(n)>Math.abs(t)?i||r:o||l)||!e.settings.wheelPropagation}function i(t){var e=t.deltaX,n=-1*t.deltaY;return void 0!==e&&void 0!==n||(e=-1*t.wheelDeltaX/6,n=t.wheelDeltaY/6),t.deltaMode&&1===t.deltaMode&&(e*=10,n*=10),e!==e&&n!==n&&(e=0,n=t.wheelDelta),t.shiftKey?[-n,-e]:[e,n]}function r(e,n,i){if(!S.isWebKit&&s.querySelector("select:focus"))return!0;if(!s.contains(e))return!1;for(var r=e;r&&r!==s;){if(r.classList.contains(b.element.consuming))return!0;var o=t(r);if([o.overflow,o.overflowX,o.overflowY].join("").match(/(scroll|auto)/)){var l=r.scrollHeight-r.clientHeight;if(l>0&&!(0===r.scrollTop&&i>0||r.scrollTop===l&&i<0))return!0;var a=r.scrollLeft-r.clientWidth;if(a>0&&!(0===r.scrollLeft&&n<0||r.scrollLeft===a&&n>0))return!0}r=r.parentNode}return!1}function o(t){var o=i(t),l=o[0],a=o[1];if(!r(t.target,l,a)){var c=!1;e.settings.useBothWheelAxes?e.scrollbarYActive&&!e.scrollbarXActive?(a?s.scrollTop-=a*e.settings.wheelSpeed:s.scrollTop+=l*e.settings.wheelSpeed,c=!0):e.scrollbarXActive&&!e.scrollbarYActive&&(l?s.scrollLeft+=l*e.settings.wheelSpeed:s.scrollLeft-=a*e.settings.wheelSpeed,c=!0):(s.scrollTop-=a*e.settings.wheelSpeed,s.scrollLeft+=l*e.settings.wheelSpeed),x(e),(c=c||n(l,a))&&!t.ctrlKey&&(t.stopPropagation(),t.preventDefault())}}var s=e.element;void 0!==window.onwheel?e.event.bind(s,"wheel",o):void 0!==window.onmousewheel&&e.event.bind(s,"mousewheel",o)},touch:function(e){function n(t,n){var i=u.scrollTop,r=u.scrollLeft,o=Math.abs(t),s=Math.abs(n);if(s>o){if(n<0&&i===e.contentHeight-e.containerHeight||n>0&&0===i)return 0===window.scrollY&&n>0&&S.isChrome}else if(o>s&&(t<0&&r===e.contentWidth-e.containerWidth||t>0&&0===r))return!0;return!0}function i(t,n){u.scrollTop-=n,u.scrollLeft-=t,x(e)}function r(t){return t.targetTouches?t.targetTouches[0]:t}function o(t){return!(t.pointerType&&"pen"===t.pointerType&&0===t.buttons||(!t.targetTouches||1!==t.targetTouches.length)&&(!t.pointerType||"mouse"===t.pointerType||t.pointerType===t.MSPOINTER_TYPE_MOUSE))}function s(t){if(o(t)){var e=r(t);p.pageX=e.pageX,p.pageY=e.pageY,d=(new Date).getTime(),null!==f&&clearInterval(f)}}function l(e,n,i){if(!u.contains(e))return!1;for(var r=e;r&&r!==u;){if(r.classList.contains(b.element.consuming))return!0;var o=t(r);if([o.overflow,o.overflowX,o.overflowY].join("").match(/(scroll|auto)/)){var s=r.scrollHeight-r.clientHeight;if(s>0&&!(0===r.scrollTop&&i>0||r.scrollTop===s&&i<0))return!0;var l=r.scrollLeft-r.clientWidth;if(l>0&&!(0===r.scrollLeft&&n<0||r.scrollLeft===l&&n>0))return!0}r=r.parentNode}return!1}function a(t){if(o(t)){var e=r(t),s={pageX:e.pageX,pageY:e.pageY},a=s.pageX-p.pageX,c=s.pageY-p.pageY;if(l(t.target,a,c))return;i(a,c),p=s;var u=(new Date).getTime(),f=u-d;f>0&&(h.x=a/f,h.y=c/f,d=u),n(a,c)&&t.preventDefault()}}function c(){e.settings.swipeEasing&&(clearInterval(f),f=setInterval(function(){e.isInitialized?clearInterval(f):h.x||h.y?Math.abs(h.x)<.01&&Math.abs(h.y)<.01?clearInterval(f):(i(30*h.x,30*h.y),h.x*=.8,h.y*=.8):clearInterval(f)},10))}if(S.supportsTouch||S.supportsIePointer){var u=e.element,p={},d=0,h={},f=null;S.supportsTouch?(e.event.bind(u,"touchstart",s),e.event.bind(u,"touchmove",a),e.event.bind(u,"touchend",c)):S.supportsIePointer&&(window.PointerEvent?(e.event.bind(u,"pointerdown",s),e.event.bind(u,"pointermove",a),e.event.bind(u,"pointerup",c)):window.MSPointerEvent&&(e.event.bind(u,"MSPointerDown",s),e.event.bind(u,"MSPointerMove",a),e.event.bind(u,"MSPointerUp",c)))}}},T=function(i,r){var o=this;if(void 0===r&&(r={}),"string"==typeof i&&(i=document.querySelector(i)),!i||!i.nodeName)throw new Error("no element is specified to initialize PerfectScrollbar");this.element=i,i.classList.add(b.main),this.settings={handlers:["click-rail","drag-thumb","keyboard","wheel","touch"],maxScrollbarLength:null,minScrollbarLength:null,scrollingThreshold:1e3,scrollXMarginOffset:0,scrollYMarginOffset:0,suppressScrollX:!1,suppressScrollY:!1,swipeEasing:!0,useBothWheelAxes:!1,wheelPropagation:!1,wheelSpeed:1};for(var s in r)o.settings[s]=r[s];this.containerWidth=null,this.containerHeight=null,this.contentWidth=null,this.contentHeight=null;var l=function(){return i.classList.add(b.state.focus)},a=function(){return i.classList.remove(b.state.focus)};this.isRtl="rtl"===t(i).direction,this.isNegativeScroll=function(){var t=i.scrollLeft,e=null;return i.scrollLeft=-1,e=i.scrollLeft<0,i.scrollLeft=t,e}(),this.negativeScrollAdjustment=this.isNegativeScroll?i.scrollWidth-i.clientWidth:0,this.event=new C,this.ownerDocument=i.ownerDocument||document,this.scrollbarXRail=n(b.element.rail("x")),i.appendChild(this.scrollbarXRail),this.scrollbarX=n(b.element.thumb("x")),this.scrollbarXRail.appendChild(this.scrollbarX),this.scrollbarX.setAttribute("tabindex",0),this.event.bind(this.scrollbarX,"focus",l),this.event.bind(this.scrollbarX,"blur",a),this.scrollbarXActive=null,this.scrollbarXWidth=null,this.scrollbarXLeft=null;var c=t(this.scrollbarXRail);this.scrollbarXBottom=parseInt(c.bottom,10),isNaN(this.scrollbarXBottom)?(this.isScrollbarXUsingBottom=!1,this.scrollbarXTop=p(c.top)):this.isScrollbarXUsingBottom=!0,this.railBorderXWidth=p(c.borderLeftWidth)+p(c.borderRightWidth),e(this.scrollbarXRail,{display:"block"}),this.railXMarginWidth=p(c.marginLeft)+p(c.marginRight),e(this.scrollbarXRail,{display:""}),this.railXWidth=null,this.railXRatio=null,this.scrollbarYRail=n(b.element.rail("y")),i.appendChild(this.scrollbarYRail),this.scrollbarY=n(b.element.thumb("y")),this.scrollbarYRail.appendChild(this.scrollbarY),this.scrollbarY.setAttribute("tabindex",0),this.event.bind(this.scrollbarY,"focus",l),this.event.bind(this.scrollbarY,"blur",a),this.scrollbarYActive=null,this.scrollbarYHeight=null,this.scrollbarYTop=null;var u=t(this.scrollbarYRail);this.scrollbarYRight=parseInt(u.right,10),isNaN(this.scrollbarYRight)?(this.isScrollbarYUsingRight=!1,this.scrollbarYLeft=p(u.left)):this.isScrollbarYUsingRight=!0,this.scrollbarYOuterWidth=this.isRtl?h(this.scrollbarY):null,this.railBorderYWidth=p(u.borderTopWidth)+p(u.borderBottomWidth),e(this.scrollbarYRail,{display:"block"}),this.railYMarginHeight=p(u.marginTop)+p(u.marginBottom),e(this.scrollbarYRail,{display:""}),this.railYHeight=null,this.railYRatio=null,this.reach={x:i.scrollLeft<=0?"start":i.scrollLeft>=this.contentWidth-this.containerWidth?"end":null,y:i.scrollTop<=0?"start":i.scrollTop>=this.contentHeight-this.containerHeight?"end":null},this.isAlive=!0,this.settings.handlers.forEach(function(t){return I[t](o)}),this.lastScrollTop=i.scrollTop,this.lastScrollLeft=i.scrollLeft,this.event.bind(this.element,"scroll",function(t){return o.onScroll(t)}),x(this)};return T.prototype.update=function(){this.isAlive&&(this.negativeScrollAdjustment=this.isNegativeScroll?this.element.scrollWidth-this.element.clientWidth:0,e(this.scrollbarXRail,{display:"block"}),e(this.scrollbarYRail,{display:"block"}),this.railXMarginWidth=p(t(this.scrollbarXRail).marginLeft)+p(t(this.scrollbarXRail).marginRight),this.railYMarginHeight=p(t(this.scrollbarYRail).marginTop)+p(t(this.scrollbarYRail).marginBottom),e(this.scrollbarXRail,{display:"none"}),e(this.scrollbarYRail,{display:"none"}),x(this),$(this,"top",0,!1,!0),$(this,"left",0,!1,!0),e(this.scrollbarXRail,{display:""}),e(this.scrollbarYRail,{display:""}))},T.prototype.onScroll=function(t){this.isAlive&&(x(this),$(this,"top",this.element.scrollTop-this.lastScrollTop),$(this,"left",this.element.scrollLeft-this.lastScrollLeft),this.lastScrollTop=this.element.scrollTop,this.lastScrollLeft=this.element.scrollLeft)},T.prototype.destroy=function(){this.isAlive&&(this.event.unbindAll(),r(this.scrollbarX),r(this.scrollbarY),r(this.scrollbarXRail),r(this.scrollbarYRail),this.removePsClasses(),this.element=null,this.scrollbarX=null,this.scrollbarY=null,this.scrollbarXRail=null,this.scrollbarYRail=null,this.isAlive=!1)},T.prototype.removePsClasses=function(){this.element.className=this.element.className.split(" ").filter(function(t){return!t.match(/^ps([-_].+|)$/)}).join(" ")},T}),function(t,e){"function"==typeof define&&define.amd?define("sifter",e):"object"==typeof exports?module.exports=e():t.Sifter=e()}(this,function(){var t=function(t,e){this.items=t,this.settings=e||{diacritics:!0}};t.prototype.tokenize=function(t){if(!(t=r(String(t||"").toLowerCase()))||!t.length)return[];var e,n,i,s,a=[],c=t.split(/ +/);for(e=0,n=c.length;e<n;e++){if(i=o(c[e]),this.settings.diacritics)for(s in l)l.hasOwnProperty(s)&&(i=i.replace(new RegExp(s,"g"),l[s]));a.push({string:c[e],regex:new RegExp(i,"i")})}return a},t.prototype.iterator=function(t,e){var n;n=s(t)?Array.prototype.forEach||function(t){for(var e=0,n=this.length;e<n;e++)t(this[e],e,this)}:function(t){for(var e in this)this.hasOwnProperty(e)&&t(this[e],e,this)},n.apply(t,[e])},t.prototype.getScoreFunction=function(t,e){var n,r,o,s,l;n=this,t=n.prepareSearch(t,e),o=t.tokens,r=t.options.fields,s=o.length,l=t.options.nesting;var a=function(t,e){var n,i;return t?(t=String(t||""),i=t.search(e.regex),-1===i?0:(n=e.string.length/t.length,0===i&&(n+=.5),n)):0},c=function(){var t=r.length;return t?1===t?function(t,e){return a(i(e,r[0],l),t)}:function(e,n){for(var o=0,s=0;o<t;o++)s+=a(i(n,r[o],l),e);return s/t}:function(){return 0}}();return s?1===s?function(t){return c(o[0],t)}:"and"===t.options.conjunction?function(t){for(var e,n=0,i=0;n<s;n++){if((e=c(o[n],t))<=0)return 0;i+=e}return i/s}:function(t){for(var e=0,n=0;e<s;e++)n+=c(o[e],t);return n/s}:function(){return 0}},t.prototype.getSortFunction=function(t,n){var r,o,s,l,a,c,u,p,d,h,f;if(s=this,t=s.prepareSearch(t,n),f=!t.query&&n.sort_empty||n.sort,d=function(t,e){return"$score"===t?e.score:i(s.items[e.id],t,n.nesting)},a=[],f)for(r=0,o=f.length;r<o;r++)(t.query||"$score"!==f[r].field)&&a.push(f[r]);if(t.query){for(h=!0,r=0,o=a.length;r<o;r++)if("$score"===a[r].field){h=!1;break}h&&a.unshift({field:"$score",direction:"desc"})}else for(r=0,o=a.length;r<o;r++)if("$score"===a[r].field){a.splice(r,1);break}for(p=[],r=0,o=a.length;r<o;r++)p.push("desc"===a[r].direction?-1:1);return c=a.length,c?1===c?(l=a[0].field,u=p[0],function(t,n){return u*e(d(l,t),d(l,n))}):function(t,n){var i,r,o;for(i=0;i<c;i++)if(o=a[i].field,r=p[i]*e(d(o,t),d(o,n)))return r;return 0}:null},t.prototype.prepareSearch=function(t,e){if("object"==typeof t)return t;e=n({},e);var i=e.fields,r=e.sort,o=e.sort_empty;return i&&!s(i)&&(e.fields=[i]),r&&!s(r)&&(e.sort=[r]),o&&!s(o)&&(e.sort_empty=[o]),{options:e,query:String(t||"").toLowerCase(),tokens:this.tokenize(t),total:0,items:[]}},t.prototype.search=function(t,e){var n,i,r,o,s=this;return i=this.prepareSearch(t,e),e=i.options,t=i.query,o=e.score||s.getScoreFunction(i),t.length?s.iterator(s.items,function(t,r){n=o(t),(!1===e.filter||n>0)&&i.items.push({score:n,id:r})}):s.iterator(s.items,function(t,e){i.items.push({score:1,id:e})}),r=s.getSortFunction(i,e),r&&i.items.sort(r),i.total=i.items.length,"number"==typeof e.limit&&(i.items=i.items.slice(0,e.limit)),i};var e=function(t,e){return"number"==typeof t&&"number"==typeof e?t>e?1:t<e?-1:0:(t=a(String(t||"")),e=a(String(e||"")),t>e?1:e>t?-1:0)},n=function(t,e){var n,i,r,o;for(n=1,i=arguments.length;n<i;n++)if(o=arguments[n])for(r in o)o.hasOwnProperty(r)&&(t[r]=o[r]);return t},i=function(t,e,n){if(t&&e){if(!n)return t[e];for(var i=e.split(".");i.length&&(t=t[i.shift()]););return t}},r=function(t){return(t+"").replace(/^\s+|\s+$|/g,"")},o=function(t){return(t+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},s=Array.isArray||"undefined"!=typeof $&&$.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},l={a:"[aḀḁĂăÂâǍǎȺⱥȦȧẠạÄäÀàÁáĀāÃãÅåąĄÃąĄ]",b:"[b␢βΒB฿𐌁ᛒ]",c:"[cĆćĈĉČčĊċC̄c̄ÇçḈḉȻȼƇƈɕᴄＣｃ]",d:"[dĎďḊḋḐḑḌḍḒḓḎḏĐđD̦d̦ƉɖƊɗƋƌᵭᶁᶑȡᴅＤｄð]",e:"[eÉéÈèÊêḘḙĚěĔĕẼẽḚḛẺẻĖėËëĒēȨȩĘęᶒɆɇȄȅẾếỀềỄễỂểḜḝḖḗḔḕȆȇẸẹỆệⱸᴇＥｅɘǝƏƐε]",f:"[fƑƒḞḟ]",g:"[gɢ₲ǤǥĜĝĞğĢģƓɠĠġ]",h:"[hĤĥĦħḨḩẖẖḤḥḢḣɦʰǶƕ]",i:"[iÍíÌìĬĭÎîǏǐÏïḮḯĨĩĮįĪīỈỉȈȉȊȋỊịḬḭƗɨɨ̆ᵻᶖİiIıɪＩｉ]",j:"[jȷĴĵɈɉʝɟʲ]",k:"[kƘƙꝀꝁḰḱǨǩḲḳḴḵκϰ₭]",l:"[lŁłĽľĻļĹĺḶḷḸḹḼḽḺḻĿŀȽƚⱠⱡⱢɫɬᶅɭȴʟＬｌ]",n:"[nŃńǸǹŇňÑñṄṅŅņṆṇṊṋṈṉN̈n̈ƝɲȠƞᵰᶇɳȵɴＮｎŊŋ]",o:"[oØøÖöÓóÒòÔôǑǒŐőŎŏȮȯỌọƟɵƠơỎỏŌōÕõǪǫȌȍՕօ]",p:"[pṔṕṖṗⱣᵽƤƥᵱ]",q:"[qꝖꝗʠɊɋꝘꝙq̃]",r:"[rŔŕɌɍŘřŖŗṘṙȐȑȒȓṚṛⱤɽ]",s:"[sŚśṠṡṢṣꞨꞩŜŝŠšŞşȘșS̈s̈]",t:"[tŤťṪṫŢţṬṭƮʈȚțṰṱṮṯƬƭ]",u:"[uŬŭɄʉỤụÜüÚúÙùÛûǓǔŰűŬŭƯưỦủŪūŨũŲųȔȕ∪]",v:"[vṼṽṾṿƲʋꝞꝟⱱʋ]",w:"[wẂẃẀẁŴŵẄẅẆẇẈẉ]",x:"[xẌẍẊẋχ]",y:"[yÝýỲỳŶŷŸÿỸỹẎẏỴỵɎɏƳƴ]",z:"[zŹźẐẑŽžŻżẒẓẔẕƵƶ]"},a=function(){var t,e,n,i,r="",o={};for(n in l)if(l.hasOwnProperty(n))for(i=l[n].substring(2,l[n].length-1),r+=i,t=0,e=i.length;t<e;t++)o[i.charAt(t)]=n;var s=new RegExp("["+r+"]","g");return function(t){return t.replace(s,function(t){return o[t]}).toLowerCase()}}();return t}),function(t,e){"function"==typeof define&&define.amd?define("microplugin",e):"object"==typeof exports?module.exports=e():t.MicroPlugin=e()}(this,function(){var t={};t.mixin=function(t){t.plugins={},t.prototype.initializePlugins=function(t){var n,i,r,o=this,s=[];if(o.plugins={names:[],settings:{},requested:{},loaded:{}},e.isArray(t))for(n=0,i=t.length;n<i;n++)"string"==typeof t[n]?s.push(t[n]):(o.plugins.settings[t[n].name]=t[n].options,s.push(t[n].name));else if(t)for(r in t)t.hasOwnProperty(r)&&(o.plugins.settings[r]=t[r],s.push(r));for(;s.length;)o.require(s.shift())},t.prototype.loadPlugin=function(e){var n=this,i=n.plugins,r=t.plugins[e];if(!t.plugins.hasOwnProperty(e))throw new Error('Unable to find "'+e+'" plugin');i.requested[e]=!0,i.loaded[e]=r.fn.apply(n,[n.plugins.settings[e]||{}]),i.names.push(e)},t.prototype.require=function(t){var e=this,n=e.plugins;if(!e.plugins.loaded.hasOwnProperty(t)){if(n.requested[t])throw new Error('Plugin has circular dependency ("'+t+'")');e.loadPlugin(t)}return n.loaded[t]},t.define=function(e,n){t.plugins[e]={name:e,fn:n}}};var e={isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}};return t}),function(t,e){"function"==typeof define&&define.amd?define("selectize",["jquery","sifter","microplugin"],e):"object"==typeof exports?module.exports=e(require("jquery"),require("sifter"),require("microplugin")):t.Selectize=e(t.jQuery,t.Sifter,t.MicroPlugin)}(this,function(t,e,n){"use strict";var i=function(t,e){if("string"!=typeof e||e.length){var n="string"==typeof e?new RegExp(e,"i"):e,i=function(t){var e=0;if(3===t.nodeType){var r=t.data.search(n);if(r>=0&&t.data.length>0){var o=t.data.match(n),s=document.createElement("span");s.className="highlight";var l=t.splitText(r),a=(l.splitText(o[0].length),l.cloneNode(!0));s.appendChild(a),l.parentNode.replaceChild(s,l),e=1}}else if(1===t.nodeType&&t.childNodes&&!/(script|style)/i.test(t.tagName))for(var c=0;c<t.childNodes.length;++c)c+=i(t.childNodes[c]);return e};return t.each(function(){i(this)})}};t.fn.removeHighlight=function(){return this.find("span.highlight").each(function(){this.parentNode.firstChild.nodeName;var t=this.parentNode;t.replaceChild(this.firstChild,this),t.normalize()}).end()};var r=function(){};r.prototype={on:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},off:function(t,e){var n=arguments.length;return 0===n?delete this._events:1===n?delete this._events[t]:(this._events=this._events||{},void(t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)))},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},r.mixin=function(t){for(var e=["on","off","trigger"],n=0;n<e.length;n++)t.prototype[e[n]]=r.prototype[e[n]]};var o=/Mac/.test(navigator.userAgent),s=o?91:17,l=o?18:17,a=!/android/i.test(window.navigator.userAgent)&&!!document.createElement("input").validity,c=function(t){return void 0!==t},u=function(t){return void 0===t||null===t?null:"boolean"==typeof t?t?"1":"0":t+""},p=function(t){return(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},d={};d.before=function(t,e,n){var i=t[e];t[e]=function(){return n.apply(t,arguments),i.apply(t,arguments)}},d.after=function(t,e,n){var i=t[e];t[e]=function(){var e=i.apply(t,arguments);return n.apply(t,arguments),e}};var h=function(t){var e=!1;return function(){e||(e=!0,t.apply(this,arguments))}},f=function(t,e){var n;return function(){var i=this,r=arguments;window.clearTimeout(n),n=window.setTimeout(function(){t.apply(i,r)},e)}},g=function(t,e,n){var i,r=t.trigger,o={};t.trigger=function(){var n=arguments[0];return-1===e.indexOf(n)?r.apply(t,arguments):void(o[n]=arguments)},n.apply(t,[]),t.trigger=r;for(i in o)o.hasOwnProperty(i)&&r.apply(t,o[i])},v=function(t,e,n,i){t.on(e,n,function(e){for(var n=e.target;n&&n.parentNode!==t[0];)n=n.parentNode;return e.currentTarget=n,i.apply(this,[e])})},m=function(t){var e={};if("selectionStart"in t)e.start=t.selectionStart,e.length=t.selectionEnd-e.start;else if(document.selection){t.focus();var n=document.selection.createRange(),i=document.selection.createRange().text.length;n.moveStart("character",-t.value.length),e.start=n.text.length-i,e.length=i}return e},b=function(t,e,n){var i,r,o={};if(n)for(i=0,r=n.length;i<r;i++)o[n[i]]=t.css(n[i]);else o=t.css();e.css(o)},y=function(e,n){if(!e)return 0;var i=t("<test>").css({position:"absolute",top:-99999,left:-99999,width:"auto",padding:0,whiteSpace:"pre"}).text(e).appendTo("body");b(n,i,["letterSpacing","fontSize","fontFamily","fontWeight","textTransform"]);var r=i.width();return i.remove(),r},w=function(t){var e=null,n=function(n,i){var r,o,s,l,a,c,u,p;n=n||window.event||{},i=i||{},n.metaKey||n.altKey||(i.force||!1!==t.data("grow"))&&(r=t.val(),n.type&&"keydown"===n.type.toLowerCase()&&(o=n.keyCode,s=o>=97&&o<=122||o>=65&&o<=90||o>=48&&o<=57||32===o,46===o||8===o?(p=m(t[0]),p.length?r=r.substring(0,p.start)+r.substring(p.start+p.length):8===o&&p.start?r=r.substring(0,p.start-1)+r.substring(p.start+1):46===o&&void 0!==p.start&&(r=r.substring(0,p.start)+r.substring(p.start+1))):s&&(c=n.shiftKey,u=String.fromCharCode(n.keyCode),u=c?u.toUpperCase():u.toLowerCase(),r+=u)),l=t.attr("placeholder"),!r&&l&&(r=l),(a=y(r,t)+4)!==e&&(e=a,t.width(a),t.triggerHandler("resize")))};t.on("keydown keyup update blur",n),n()},O=function(t){var e=document.createElement("div");return e.appendChild(t.cloneNode(!0)),e.innerHTML},C=function(n,i){var r,o,s,l,a=this;l=n[0],l.selectize=a;var c=window.getComputedStyle&&window.getComputedStyle(l,null);if(s=c?c.getPropertyValue("direction"):l.currentStyle&&l.currentStyle.direction,s=s||n.parents("[dir]:first").attr("dir")||"",t.extend(a,{order:0,settings:i,$input:n,tabIndex:n.attr("tabindex")||"",tagType:"select"===l.tagName.toLowerCase()?1:2,rtl:/rtl/i.test(s),eventNS:".selectize"+ ++C.count,highlightedValue:null,isOpen:!1,isDisabled:!1,isRequired:n.is("[required]"),isInvalid:!1,isLocked:!1,isFocused:!1,isInputHidden:!1,isSetup:!1,isShiftDown:!1,isCmdDown:!1,isCtrlDown:!1,ignoreFocus:!1,ignoreBlur:!1,ignoreHover:!1,hasOptions:!1,currentResults:null,lastValue:"",caretPos:0,loading:0,loadedSearches:{},$activeOption:null,$activeItems:[],optgroups:{},options:{},userOptions:{},items:[],renderCache:{},onSearchChange:null===i.loadThrottle?a.onSearchChange:f(a.onSearchChange,i.loadThrottle)}),a.sifter=new e(this.options,{diacritics:i.diacritics}),a.settings.options){for(r=0,o=a.settings.options.length;r<o;r++)a.registerOption(a.settings.options[r]);delete a.settings.options}if(a.settings.optgroups){for(r=0,o=a.settings.optgroups.length;r<o;r++)a.registerOptionGroup(a.settings.optgroups[r]);delete a.settings.optgroups}a.settings.mode=a.settings.mode||(1===a.settings.maxItems?"single":"multi"),"boolean"!=typeof a.settings.hideSelected&&(a.settings.hideSelected="multi"===a.settings.mode),a.initializePlugins(a.settings.plugins),a.setupCallbacks(),a.setupTemplates(),a.setup()};return r.mixin(C),void 0!==n?n.mixin(C):function(t,e){e||(e={});console.error("Selectize: "+t),e.explanation&&(console.group&&console.group(),console.error(e.explanation),console.group&&console.groupEnd())}("Dependency MicroPlugin is missing",{explanation:'Make sure you either: (1) are using the "standalone" version of Selectize, or (2) require MicroPlugin before you load Selectize.'}),t.extend(C.prototype,{setup:function(){var e,n,i,r,c,u,p,d,h,f,g=this,m=g.settings,b=g.eventNS,y=t(window),O=t(document),C=g.$input;if(p=g.settings.mode,d=C.attr("class")||"",e=t("<div>").addClass(m.wrapperClass).addClass(d).addClass(p),n=t("<div>").addClass(m.inputClass).addClass("items").appendTo(e),i=t('<input type="text" autocomplete="off" />').appendTo(n).attr("tabindex",C.is(":disabled")?"-1":g.tabIndex),u=t(m.dropdownParent||e),r=t("<div>").addClass(m.dropdownClass).addClass(p).hide().appendTo(u),c=t("<div>").addClass(m.dropdownContentClass).appendTo(r),(f=C.attr("id"))&&(i.attr("id",f+"-selectized"),t("label[for='"+f+"']").attr("for",f+"-selectized")),g.settings.copyClassesToDropdown&&r.addClass(d),e.css({width:C[0].style.width}),g.plugins.names.length&&(h="plugin-"+g.plugins.names.join(" plugin-"),e.addClass(h),r.addClass(h)),(null===m.maxItems||m.maxItems>1)&&1===g.tagType&&C.attr("multiple","multiple"),g.settings.placeholder&&i.attr("placeholder",m.placeholder),!g.settings.splitOn&&g.settings.delimiter){var $=g.settings.delimiter.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");g.settings.splitOn=new RegExp("\\s*"+$+"+\\s*")}C.attr("autocorrect")&&i.attr("autocorrect",C.attr("autocorrect")),C.attr("autocapitalize")&&i.attr("autocapitalize",C.attr("autocapitalize")),g.$wrapper=e,g.$control=n,g.$control_input=i,g.$dropdown=r,g.$dropdown_content=c,r.on("mouseenter","[data-selectable]",function(){return g.onOptionHover.apply(g,arguments)}),r.on("mousedown click","[data-selectable]",function(){return g.onOptionSelect.apply(g,arguments)}),v(n,"mousedown","*:not(input)",function(){return g.onItemSelect.apply(g,arguments)}),w(i),n.on({mousedown:function(){return g.onMouseDown.apply(g,arguments)},click:function(){return g.onClick.apply(g,arguments)}}),i.on({mousedown:function(t){t.stopPropagation()},keydown:function(){return g.onKeyDown.apply(g,arguments)},keyup:function(){return g.onKeyUp.apply(g,arguments)},
keypress:function(){return g.onKeyPress.apply(g,arguments)},resize:function(){g.positionDropdown.apply(g,[])},blur:function(){return g.onBlur.apply(g,arguments)},focus:function(){return g.ignoreBlur=!1,g.onFocus.apply(g,arguments)},paste:function(){return g.onPaste.apply(g,arguments)}}),O.on("keydown"+b,function(t){g.isCmdDown=t[o?"metaKey":"ctrlKey"],g.isCtrlDown=t[o?"altKey":"ctrlKey"],g.isShiftDown=t.shiftKey}),O.on("keyup"+b,function(t){t.keyCode===l&&(g.isCtrlDown=!1),16===t.keyCode&&(g.isShiftDown=!1),t.keyCode===s&&(g.isCmdDown=!1)}),O.on("mousedown"+b,function(t){if(g.isFocused){if(t.target===g.$dropdown[0]||t.target.parentNode===g.$dropdown[0])return!1;g.$control.has(t.target).length||t.target===g.$control[0]||g.blur(t.target)}}),y.on(["scroll"+b,"resize"+b].join(" "),function(){g.isOpen&&g.positionDropdown.apply(g,arguments)}),y.on("mousemove"+b,function(){g.ignoreHover=!1}),this.revertSettings={$children:C.children().detach(),tabindex:C.attr("tabindex")},C.attr("tabindex",-1).hide().after(g.$wrapper),t.isArray(m.items)&&(g.setValue(m.items),delete m.items),a&&C.on("invalid"+b,function(t){t.preventDefault(),g.isInvalid=!0,g.refreshState()}),g.updateOriginalInput(),g.refreshItems(),g.refreshState(),g.updatePlaceholder(),g.isSetup=!0,C.is(":disabled")&&g.disable(),g.on("change",this.onChange),C.data("selectize",g),C.addClass("selectized"),g.trigger("initialize"),!0===m.preload&&g.onSearchChange("")},setupTemplates:function(){var e=this,n=e.settings.labelField,i=e.settings.optgroupLabelField,r={optgroup:function(t){return'<div class="optgroup">'+t.html+"</div>"},optgroup_header:function(t,e){return'<div class="optgroup-header">'+e(t[i])+"</div>"},option:function(t,e){return'<div class="option">'+e(t[n])+"</div>"},item:function(t,e){return'<div class="item">'+e(t[n])+"</div>"},option_create:function(t,e){return'<div class="create">Add <strong>'+e(t.input)+"</strong>&hellip;</div>"}};e.settings.render=t.extend({},r,e.settings.render)},setupCallbacks:function(){var t,e,n={initialize:"onInitialize",change:"onChange",item_add:"onItemAdd",item_remove:"onItemRemove",clear:"onClear",option_add:"onOptionAdd",option_remove:"onOptionRemove",option_clear:"onOptionClear",optgroup_add:"onOptionGroupAdd",optgroup_remove:"onOptionGroupRemove",optgroup_clear:"onOptionGroupClear",dropdown_open:"onDropdownOpen",dropdown_close:"onDropdownClose",type:"onType",load:"onLoad",focus:"onFocus",blur:"onBlur"};for(t in n)n.hasOwnProperty(t)&&(e=this.settings[n[t]])&&this.on(t,e)},onClick:function(t){var e=this;e.isFocused||(e.focus(),t.preventDefault())},onMouseDown:function(e){var n=this,i=e.isDefaultPrevented();if(t(e.target),n.isFocused){if(e.target!==n.$control_input[0])return"single"===n.settings.mode?n.isOpen?n.close():n.open():i||n.setActiveItem(null),!1}else i||window.setTimeout(function(){n.focus()},0)},onChange:function(){this.$input.trigger("change")},onPaste:function(e){var n=this;return n.isFull()||n.isInputHidden||n.isLocked?void e.preventDefault():void(n.settings.splitOn&&setTimeout(function(){var e=n.$control_input.val();if(e.match(n.settings.splitOn))for(var i=t.trim(e).split(n.settings.splitOn),r=0,o=i.length;r<o;r++)n.createItem(i[r])},0))},onKeyPress:function(t){if(this.isLocked)return t&&t.preventDefault();var e=String.fromCharCode(t.keyCode||t.which);return this.settings.create&&"multi"===this.settings.mode&&e===this.settings.delimiter?(this.createItem(),t.preventDefault(),!1):void 0},onKeyDown:function(t){var e=(t.target,this.$control_input[0],this);if(e.isLocked)return void(9!==t.keyCode&&t.preventDefault());switch(t.keyCode){case 65:if(e.isCmdDown)return void e.selectAll();break;case 27:return void(e.isOpen&&(t.preventDefault(),t.stopPropagation(),e.close()));case 78:if(!t.ctrlKey||t.altKey)break;case 40:if(!e.isOpen&&e.hasOptions)e.open();else if(e.$activeOption){e.ignoreHover=!0;var n=e.getAdjacentOption(e.$activeOption,1);n.length&&e.setActiveOption(n,!0,!0)}return void t.preventDefault();case 80:if(!t.ctrlKey||t.altKey)break;case 38:if(e.$activeOption){e.ignoreHover=!0;var i=e.getAdjacentOption(e.$activeOption,-1);i.length&&e.setActiveOption(i,!0,!0)}return void t.preventDefault();case 13:return void(e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),t.preventDefault()));case 37:return void e.advanceSelection(-1,t);case 39:return void e.advanceSelection(1,t);case 9:return e.settings.selectOnTab&&e.isOpen&&e.$activeOption&&(e.onOptionSelect({currentTarget:e.$activeOption}),e.isFull()||t.preventDefault()),void(e.settings.create&&e.createItem()&&t.preventDefault());case 8:case 46:return void e.deleteSelection(t)}return!e.isFull()&&!e.isInputHidden||(o?t.metaKey:t.ctrlKey)?void 0:void t.preventDefault()},onKeyUp:function(t){var e=this;if(e.isLocked)return t&&t.preventDefault();var n=e.$control_input.val()||"";e.lastValue!==n&&(e.lastValue=n,e.onSearchChange(n),e.refreshOptions(),e.trigger("type",n))},onSearchChange:function(t){var e=this,n=e.settings.load;n&&(e.loadedSearches.hasOwnProperty(t)||(e.loadedSearches[t]=!0,e.load(function(i){n.apply(e,[t,i])})))},onFocus:function(t){var e=this,n=e.isFocused;return e.isDisabled?(e.blur(),t&&t.preventDefault(),!1):void(e.ignoreFocus||(e.isFocused=!0,"focus"===e.settings.preload&&e.onSearchChange(""),n||e.trigger("focus"),e.$activeItems.length||(e.showInput(),e.setActiveItem(null),e.refreshOptions(!!e.settings.openOnFocus)),e.refreshState()))},onBlur:function(t,e){var n=this;if(n.isFocused&&(n.isFocused=!1,!n.ignoreFocus)){if(!n.ignoreBlur&&document.activeElement===n.$dropdown_content[0])return n.ignoreBlur=!0,void n.onFocus(t);var i=function(){n.close(),n.setTextboxValue(""),n.setActiveItem(null),n.setActiveOption(null),n.setCaret(n.items.length),n.refreshState(),e&&e.focus&&e.focus(),n.ignoreFocus=!1,n.trigger("blur")};n.ignoreFocus=!0,n.settings.create&&n.settings.createOnBlur?n.createItem(null,!1,i):i()}},onOptionHover:function(t){this.ignoreHover||this.setActiveOption(t.currentTarget,!1)},onOptionSelect:function(e){var n,i,r=this;e.preventDefault&&(e.preventDefault(),e.stopPropagation()),i=t(e.currentTarget),i.hasClass("create")?r.createItem(null,function(){r.settings.closeAfterSelect&&r.close()}):void 0!==(n=i.attr("data-value"))&&(r.lastQuery=null,r.setTextboxValue(""),r.addItem(n),r.settings.closeAfterSelect?r.close():!r.settings.hideSelected&&e.type&&/mouse/.test(e.type)&&r.setActiveOption(r.getOption(n)))},onItemSelect:function(t){var e=this;e.isLocked||"multi"===e.settings.mode&&(t.preventDefault(),e.setActiveItem(t.currentTarget,t))},load:function(t){var e=this,n=e.$wrapper.addClass(e.settings.loadingClass);e.loading++,t.apply(e,[function(t){e.loading=Math.max(e.loading-1,0),t&&t.length&&(e.addOption(t),e.refreshOptions(e.isFocused&&!e.isInputHidden)),e.loading||n.removeClass(e.settings.loadingClass),e.trigger("load",t)}])},setTextboxValue:function(t){var e=this.$control_input;e.val()!==t&&(e.val(t).triggerHandler("update"),this.lastValue=t)},getValue:function(){return 1===this.tagType&&this.$input.attr("multiple")?this.items:this.items.join(this.settings.delimiter)},setValue:function(t,e){g(this,e?[]:["change"],function(){this.clear(e),this.addItems(t,e)})},setActiveItem:function(e,n){var i,r,o,s,l,a,c,u,p=this;if("single"!==p.settings.mode){if(e=t(e),!e.length)return t(p.$activeItems).removeClass("active"),p.$activeItems=[],void(p.isFocused&&p.showInput());if("mousedown"===(i=n&&n.type.toLowerCase())&&p.isShiftDown&&p.$activeItems.length){for(u=p.$control.children(".active:last"),s=Array.prototype.indexOf.apply(p.$control[0].childNodes,[u[0]]),l=Array.prototype.indexOf.apply(p.$control[0].childNodes,[e[0]]),s>l&&(c=s,s=l,l=c),r=s;r<=l;r++)a=p.$control[0].childNodes[r],-1===p.$activeItems.indexOf(a)&&(t(a).addClass("active"),p.$activeItems.push(a));n.preventDefault()}else"mousedown"===i&&p.isCtrlDown||"keydown"===i&&this.isShiftDown?e.hasClass("active")?(o=p.$activeItems.indexOf(e[0]),p.$activeItems.splice(o,1),e.removeClass("active")):p.$activeItems.push(e.addClass("active")[0]):(t(p.$activeItems).removeClass("active"),p.$activeItems=[e.addClass("active")[0]]);p.hideInput(),this.isFocused||p.focus()}},setActiveOption:function(e,n,i){var r,o,s,l,a,u=this;u.$activeOption&&u.$activeOption.removeClass("active"),u.$activeOption=null,e=t(e),e.length&&(u.$activeOption=e.addClass("active"),!n&&c(n)||(r=u.$dropdown_content.height(),o=u.$activeOption.outerHeight(!0),n=u.$dropdown_content.scrollTop()||0,s=u.$activeOption.offset().top-u.$dropdown_content.offset().top+n,l=s,a=s-r+o,s+o>r+n?u.$dropdown_content.stop().animate({scrollTop:a},i?u.settings.scrollDuration:0):s<n&&u.$dropdown_content.stop().animate({scrollTop:l},i?u.settings.scrollDuration:0)))},selectAll:function(){var t=this;"single"!==t.settings.mode&&(t.$activeItems=Array.prototype.slice.apply(t.$control.children(":not(input)").addClass("active")),t.$activeItems.length&&(t.hideInput(),t.close()),t.focus())},hideInput:function(){var t=this;t.setTextboxValue(""),t.$control_input.css({opacity:0,position:"absolute",left:t.rtl?1e4:-1e4}),t.isInputHidden=!0},showInput:function(){this.$control_input.css({opacity:1,position:"relative",left:0}),this.isInputHidden=!1},focus:function(){var t=this;t.isDisabled||(t.ignoreFocus=!0,t.$control_input[0].focus(),window.setTimeout(function(){t.ignoreFocus=!1,t.onFocus()},0))},blur:function(t){this.$control_input[0].blur(),this.onBlur(null,t)},getScoreFunction:function(t){return this.sifter.getScoreFunction(t,this.getSearchOptions())},getSearchOptions:function(){var t=this.settings,e=t.sortField;return"string"==typeof e&&(e=[{field:e}]),{fields:t.searchField,conjunction:t.searchConjunction,sort:e}},search:function(e){var n,i,r,o=this,s=o.settings,l=this.getSearchOptions();if(s.score&&"function"!=typeof(r=o.settings.score.apply(this,[e])))throw new Error('Selectize "score" setting must be a function that returns a function');if(e!==o.lastQuery?(o.lastQuery=e,i=o.sifter.search(e,t.extend(l,{score:r})),o.currentResults=i):i=t.extend(!0,{},o.currentResults),s.hideSelected)for(n=i.items.length-1;n>=0;n--)-1!==o.items.indexOf(u(i.items[n].id))&&i.items.splice(n,1);return i},refreshOptions:function(e){var n,r,o,s,l,a,c,p,d,h,f,g,v,m,b,y;void 0===e&&(e=!0);var w=this,C=t.trim(w.$control_input.val()),$=w.search(C),S=w.$dropdown_content,x=w.$activeOption&&u(w.$activeOption.attr("data-value"));for(s=$.items.length,"number"==typeof w.settings.maxOptions&&(s=Math.min(s,w.settings.maxOptions)),l={},a=[],n=0;n<s;n++)for(c=w.options[$.items[n].id],p=w.render("option",c),d=c[w.settings.optgroupField]||"",h=t.isArray(d)?d:[d],r=0,o=h&&h.length;r<o;r++)d=h[r],w.optgroups.hasOwnProperty(d)||(d=""),l.hasOwnProperty(d)||(l[d]=document.createDocumentFragment(),a.push(d)),l[d].appendChild(p);for(this.settings.lockOptgroupOrder&&a.sort(function(t,e){return(w.optgroups[t].$order||0)-(w.optgroups[e].$order||0)}),f=document.createDocumentFragment(),n=0,s=a.length;n<s;n++)d=a[n],w.optgroups.hasOwnProperty(d)&&l[d].childNodes.length?(g=document.createDocumentFragment(),g.appendChild(w.render("optgroup_header",w.optgroups[d])),g.appendChild(l[d]),f.appendChild(w.render("optgroup",t.extend({},w.optgroups[d],{html:O(g),dom:g})))):f.appendChild(l[d]);if(S.html(f),w.settings.highlight&&$.query.length&&$.tokens.length)for(S.removeHighlight(),n=0,s=$.tokens.length;n<s;n++)i(S,$.tokens[n].regex);if(!w.settings.hideSelected)for(n=0,s=w.items.length;n<s;n++)w.getOption(w.items[n]).addClass("selected");v=w.canCreate(C),v&&(S.prepend(w.render("option_create",{input:C})),y=t(S[0].childNodes[0])),w.hasOptions=$.items.length>0||v,w.hasOptions?($.items.length>0?(b=x&&w.getOption(x),b&&b.length?m=b:"single"===w.settings.mode&&w.items.length&&(m=w.getOption(w.items[0])),m&&m.length||(m=y&&!w.settings.addPrecedence?w.getAdjacentOption(y,1):S.find("[data-selectable]:first"))):m=y,w.setActiveOption(m),e&&!w.isOpen&&w.open()):(w.setActiveOption(null),e&&w.isOpen&&w.close())},addOption:function(e){var n,i,r,o=this;if(t.isArray(e))for(n=0,i=e.length;n<i;n++)o.addOption(e[n]);else(r=o.registerOption(e))&&(o.userOptions[r]=!0,o.lastQuery=null,o.trigger("option_add",r,e))},registerOption:function(t){var e=u(t[this.settings.valueField]);return void 0!==e&&null!==e&&!this.options.hasOwnProperty(e)&&(t.$order=t.$order||++this.order,this.options[e]=t,e)},registerOptionGroup:function(t){var e=u(t[this.settings.optgroupValueField]);return!!e&&(t.$order=t.$order||++this.order,this.optgroups[e]=t,e)},addOptionGroup:function(t,e){e[this.settings.optgroupValueField]=t,(t=this.registerOptionGroup(e))&&this.trigger("optgroup_add",t,e)},removeOptionGroup:function(t){this.optgroups.hasOwnProperty(t)&&(delete this.optgroups[t],this.renderCache={},this.trigger("optgroup_remove",t))},clearOptionGroups:function(){this.optgroups={},this.renderCache={},this.trigger("optgroup_clear")},updateOption:function(e,n){var i,r,o,s,l,a,c,p=this;if(e=u(e),o=u(n[p.settings.valueField]),null!==e&&p.options.hasOwnProperty(e)){if("string"!=typeof o)throw new Error("Value must be set in option data");c=p.options[e].$order,o!==e&&(delete p.options[e],-1!==(s=p.items.indexOf(e))&&p.items.splice(s,1,o)),n.$order=n.$order||c,p.options[o]=n,l=p.renderCache.item,a=p.renderCache.option,l&&(delete l[e],delete l[o]),a&&(delete a[e],delete a[o]),-1!==p.items.indexOf(o)&&(i=p.getItem(e),r=t(p.render("item",n)),i.hasClass("active")&&r.addClass("active"),i.replaceWith(r)),p.lastQuery=null,p.isOpen&&p.refreshOptions(!1)}},removeOption:function(t,e){var n=this;t=u(t);var i=n.renderCache.item,r=n.renderCache.option;i&&delete i[t],r&&delete r[t],delete n.userOptions[t],delete n.options[t],n.lastQuery=null,n.trigger("option_remove",t),n.removeItem(t,e)},clearOptions:function(){var t=this;t.loadedSearches={},t.userOptions={},t.renderCache={},t.options=t.sifter.items={},t.lastQuery=null,t.trigger("option_clear"),t.clear()},getOption:function(t){return this.getElementWithValue(t,this.$dropdown_content.find("[data-selectable]"))},getAdjacentOption:function(e,n){var i=this.$dropdown.find("[data-selectable]"),r=i.index(e)+n;return r>=0&&r<i.length?i.eq(r):t()},getElementWithValue:function(e,n){if(void 0!==(e=u(e))&&null!==e)for(var i=0,r=n.length;i<r;i++)if(n[i].getAttribute("data-value")===e)return t(n[i]);return t()},getItem:function(t){return this.getElementWithValue(t,this.$control.children())},addItems:function(e,n){for(var i=t.isArray(e)?e:[e],r=0,o=i.length;r<o;r++)this.isPending=r<o-1,this.addItem(i[r],n)},addItem:function(e,n){g(this,n?[]:["change"],function(){var i,r,o,s,l,a=this,c=a.settings.mode;return e=u(e),-1!==a.items.indexOf(e)?void("single"===c&&a.close()):void(a.options.hasOwnProperty(e)&&("single"===c&&a.clear(n),"multi"===c&&a.isFull()||(i=t(a.render("item",a.options[e])),l=a.isFull(),a.items.splice(a.caretPos,0,e),a.insertAtCaret(i),(!a.isPending||!l&&a.isFull())&&a.refreshState(),a.isSetup&&(o=a.$dropdown_content.find("[data-selectable]"),a.isPending||(r=a.getOption(e),s=a.getAdjacentOption(r,1).attr("data-value"),a.refreshOptions(a.isFocused&&"single"!==c),s&&a.setActiveOption(a.getOption(s))),!o.length||a.isFull()?a.close():a.positionDropdown(),a.updatePlaceholder(),a.trigger("item_add",e,i),a.updateOriginalInput({silent:n})))))})},removeItem:function(e,n){var i,r,o,s=this;i=e instanceof t?e:s.getItem(e),e=u(i.attr("data-value")),-1!==(r=s.items.indexOf(e))&&(i.remove(),i.hasClass("active")&&(o=s.$activeItems.indexOf(i[0]),s.$activeItems.splice(o,1)),s.items.splice(r,1),s.lastQuery=null,!s.settings.persist&&s.userOptions.hasOwnProperty(e)&&s.removeOption(e,n),r<s.caretPos&&s.setCaret(s.caretPos-1),s.refreshState(),s.updatePlaceholder(),s.updateOriginalInput({silent:n}),s.positionDropdown(),s.trigger("item_remove",e,i))},createItem:function(e,n){var i=this,r=i.caretPos;e=e||t.trim(i.$control_input.val()||"");var o=arguments[arguments.length-1];if("function"!=typeof o&&(o=function(){}),"boolean"!=typeof n&&(n=!0),!i.canCreate(e))return o(),!1;i.lock();var s="function"==typeof i.settings.create?this.settings.create:function(t){var e={};return e[i.settings.labelField]=t,e[i.settings.valueField]=t,e},l=h(function(t){if(i.unlock(),!t||"object"!=typeof t)return o();var e=u(t[i.settings.valueField]);return"string"!=typeof e?o():(i.setTextboxValue(""),i.addOption(t),i.setCaret(r),i.addItem(e),i.refreshOptions(n&&"single"!==i.settings.mode),void o(t))}),a=s.apply(this,[e,l]);return void 0!==a&&l(a),!0},refreshItems:function(){this.lastQuery=null,this.isSetup&&this.addItem(this.items),this.refreshState(),this.updateOriginalInput()},refreshState:function(){this.refreshValidityState(),this.refreshClasses()},refreshValidityState:function(){if(!this.isRequired)return!1;var t=!this.items.length;this.isInvalid=t,this.$control_input.prop("required",t),this.$input.prop("required",!t)},refreshClasses:function(){var e=this,n=e.isFull(),i=e.isLocked;e.$wrapper.toggleClass("rtl",e.rtl),e.$control.toggleClass("focus",e.isFocused).toggleClass("disabled",e.isDisabled).toggleClass("required",e.isRequired).toggleClass("invalid",e.isInvalid).toggleClass("locked",i).toggleClass("full",n).toggleClass("not-full",!n).toggleClass("input-active",e.isFocused&&!e.isInputHidden).toggleClass("dropdown-active",e.isOpen).toggleClass("has-options",!t.isEmptyObject(e.options)).toggleClass("has-items",e.items.length>0),e.$control_input.data("grow",!n&&!i)},isFull:function(){return null!==this.settings.maxItems&&this.items.length>=this.settings.maxItems},updateOriginalInput:function(t){var e,n,i,r,o=this;if(t=t||{},1===o.tagType){for(i=[],e=0,n=o.items.length;e<n;e++)r=o.options[o.items[e]][o.settings.labelField]||"",i.push('<option value="'+p(o.items[e])+'" selected="selected">'+p(r)+"</option>");i.length||this.$input.attr("multiple")||i.push('<option value="" selected="selected"></option>'),o.$input.html(i.join(""))}else o.$input.val(o.getValue()),o.$input.attr("value",o.$input.val());o.isSetup&&(t.silent||o.trigger("change",o.$input.val()))},updatePlaceholder:function(){if(this.settings.placeholder){var t=this.$control_input;this.items.length?t.removeAttr("placeholder"):t.attr("placeholder",this.settings.placeholder),t.triggerHandler("update",{force:!0})}},open:function(){var t=this;t.isLocked||t.isOpen||"multi"===t.settings.mode&&t.isFull()||(t.focus(),t.isOpen=!0,t.refreshState(),t.$dropdown.css({visibility:"hidden",display:"block"}),t.positionDropdown(),t.$dropdown.css({visibility:"visible"}),t.trigger("dropdown_open",t.$dropdown))},close:function(){var t=this,e=t.isOpen;"single"===t.settings.mode&&t.items.length&&(t.hideInput(),t.$control_input.blur()),t.isOpen=!1,t.$dropdown.hide(),t.setActiveOption(null),t.refreshState(),e&&t.trigger("dropdown_close",t.$dropdown)},positionDropdown:function(){var t=this.$control,e="body"===this.settings.dropdownParent?t.offset():t.position();e.top+=t.outerHeight(!0),this.$dropdown.css({width:t.outerWidth(),top:e.top,left:e.left})},clear:function(t){var e=this;e.items.length&&(e.$control.children(":not(input)").remove(),e.items=[],e.lastQuery=null,e.setCaret(0),e.setActiveItem(null),e.updatePlaceholder(),e.updateOriginalInput({silent:t}),e.refreshState(),e.showInput(),e.trigger("clear"))},insertAtCaret:function(e){var n=Math.min(this.caretPos,this.items.length);0===n?this.$control.prepend(e):t(this.$control[0].childNodes[n]).before(e),this.setCaret(n+1)},deleteSelection:function(e){var n,i,r,o,s,l,a,c,u,p=this;if(r=e&&8===e.keyCode?-1:1,o=m(p.$control_input[0]),p.$activeOption&&!p.settings.hideSelected&&(a=p.getAdjacentOption(p.$activeOption,-1).attr("data-value")),s=[],p.$activeItems.length){for(u=p.$control.children(".active:"+(r>0?"last":"first")),l=p.$control.children(":not(input)").index(u),r>0&&l++,n=0,i=p.$activeItems.length;n<i;n++)s.push(t(p.$activeItems[n]).attr("data-value"));e&&(e.preventDefault(),e.stopPropagation())}else(p.isFocused||"single"===p.settings.mode)&&p.items.length&&(r<0&&0===o.start&&0===o.length?s.push(p.items[p.caretPos-1]):r>0&&o.start===p.$control_input.val().length&&s.push(p.items[p.caretPos]));if(!s.length||"function"==typeof p.settings.onDelete&&!1===p.settings.onDelete.apply(p,[s]))return!1;for(void 0!==l&&p.setCaret(l);s.length;)p.removeItem(s.pop());return p.showInput(),p.positionDropdown(),p.refreshOptions(!0),a&&(c=p.getOption(a),c.length&&p.setActiveOption(c)),!0},advanceSelection:function(t,e){var n,i,r,o,s,l=this;0!==t&&(l.rtl&&(t*=-1),n=t>0?"last":"first",i=m(l.$control_input[0]),l.isFocused&&!l.isInputHidden?(o=l.$control_input.val().length,(t<0?0===i.start&&0===i.length:i.start===o)&&!o&&l.advanceCaret(t,e)):(s=l.$control.children(".active:"+n),s.length&&(r=l.$control.children(":not(input)").index(s),l.setActiveItem(null),l.setCaret(t>0?r+1:r))))},advanceCaret:function(t,e){var n,i,r=this;0!==t&&(n=t>0?"next":"prev",r.isShiftDown?(i=r.$control_input[n](),i.length&&(r.hideInput(),r.setActiveItem(i),e&&e.preventDefault())):r.setCaret(r.caretPos+t))},setCaret:function(e){var n=this;if(e="single"===n.settings.mode?n.items.length:Math.max(0,Math.min(n.items.length,e)),!n.isPending){var i,r,o,s;for(o=n.$control.children(":not(input)"),i=0,r=o.length;i<r;i++)s=t(o[i]).detach(),i<e?n.$control_input.before(s):n.$control.append(s)}n.caretPos=e},lock:function(){this.close(),this.isLocked=!0,this.refreshState()},unlock:function(){this.isLocked=!1,this.refreshState()},disable:function(){var t=this;t.$input.prop("disabled",!0),t.$control_input.prop("disabled",!0).prop("tabindex",-1),t.isDisabled=!0,t.lock()},enable:function(){var t=this;t.$input.prop("disabled",!1),t.$control_input.prop("disabled",!1).prop("tabindex",t.tabIndex),t.isDisabled=!1,t.unlock()},destroy:function(){var e=this,n=e.eventNS,i=e.revertSettings;e.trigger("destroy"),e.off(),e.$wrapper.remove(),e.$dropdown.remove(),e.$input.html("").append(i.$children).removeAttr("tabindex").removeClass("selectized").attr({tabindex:i.tabindex}).show(),e.$control_input.removeData("grow"),e.$input.removeData("selectize"),t(window).off(n),t(document).off(n),t(document.body).off(n),delete e.$input[0].selectize},render:function(e,n){var i,r,o="",s=!1,l=this;return"option"!==e&&"item"!==e||(i=u(n[l.settings.valueField]),s=!!i),s&&(c(l.renderCache[e])||(l.renderCache[e]={}),l.renderCache[e].hasOwnProperty(i))?l.renderCache[e][i]:(o=t(l.settings.render[e].apply(this,[n,p])),"option"===e||"option_create"===e?o.attr("data-selectable",""):"optgroup"===e&&(r=n[l.settings.optgroupValueField]||"",o.attr("data-group",r)),"option"!==e&&"item"!==e||o.attr("data-value",i||""),s&&(l.renderCache[e][i]=o[0]),o[0])},clearCache:function(t){var e=this;void 0===t?e.renderCache={}:delete e.renderCache[t]},canCreate:function(t){var e=this;if(!e.settings.create)return!1;var n=e.settings.createFilter;return t.length&&("function"!=typeof n||n.apply(e,[t]))&&("string"!=typeof n||new RegExp(n).test(t))&&(!(n instanceof RegExp)||n.test(t))}}),C.count=0,C.defaults={options:[],optgroups:[],plugins:[],delimiter:",",splitOn:null,persist:!0,diacritics:!0,create:!1,createOnBlur:!1,createFilter:null,highlight:!0,openOnFocus:!0,maxOptions:1e3,maxItems:null,hideSelected:null,addPrecedence:!1,selectOnTab:!1,preload:!1,allowEmptyOption:!1,closeAfterSelect:!1,scrollDuration:60,loadThrottle:300,loadingClass:"loading",dataAttr:"data-data",optgroupField:"optgroup",valueField:"value",labelField:"text",optgroupLabelField:"label",optgroupValueField:"value",lockOptgroupOrder:!1,sortField:"$order",searchField:["text"],searchConjunction:"and",mode:null,wrapperClass:"selectize-control",inputClass:"selectize-input",dropdownClass:"selectize-dropdown",dropdownContentClass:"selectize-dropdown-content",dropdownParent:null,copyClassesToDropdown:!0,render:{}},t.fn.selectize=function(e){var n=t.fn.selectize.defaults,i=t.extend({},n,e),r=i.dataAttr,o=i.labelField,s=i.valueField,l=i.optgroupField,a=i.optgroupLabelField,c=i.optgroupValueField,p=function(e,n){var l,a,c,u,p=e.attr(r);if(p)for(n.options=JSON.parse(p),l=0,a=n.options.length;l<a;l++)n.items.push(n.options[l][s]);else{var d=t.trim(e.val()||"");if(!i.allowEmptyOption&&!d.length)return;for(c=d.split(i.delimiter),l=0,a=c.length;l<a;l++)u={},u[o]=c[l],u[s]=c[l],n.options.push(u);n.items=c}},d=function(e,n){var p,d,h,f,g=n.options,v={},m=function(t){var e=r&&t.attr(r);return"string"==typeof e&&e.length?JSON.parse(e):null},b=function(e,r){e=t(e);var a=u(e.val());if(a||i.allowEmptyOption)if(v.hasOwnProperty(a)){if(r){var c=v[a][l];c?t.isArray(c)?c.push(r):v[a][l]=[c,r]:v[a][l]=r}}else{var p=m(e)||{};p[o]=p[o]||e.text(),p[s]=p[s]||a,p[l]=p[l]||r,v[a]=p,g.push(p),e.is(":selected")&&n.items.push(a)}};for(n.maxItems=e.attr("multiple")?null:1,f=e.children(),p=0,d=f.length;p<d;p++)h=f[p].tagName.toLowerCase(),"optgroup"===h?function(e){var i,r,o,s,l;for(e=t(e),o=e.attr("label"),o&&(s=m(e)||{},s[a]=o,s[c]=o,n.optgroups.push(s)),l=t("option",e),i=0,r=l.length;i<r;i++)b(l[i],o)}(f[p]):"option"===h&&b(f[p])};return this.each(function(){if(!this.selectize){var r=t(this),o=this.tagName.toLowerCase(),s=r.attr("placeholder")||r.attr("data-placeholder");s||i.allowEmptyOption||(s=r.children('option[value=""]').text());var l={placeholder:s,options:[],optgroups:[],items:[]};"select"===o?d(r,l):p(r,l),new C(r,t.extend(!0,{},n,l,e))}})},t.fn.selectize.defaults=C.defaults,t.fn.selectize.support={validity:a},C.define("drag_drop",function(e){if(!t.fn.sortable)throw new Error('The "drag_drop" plugin requires jQuery UI "sortable".');if("multi"===this.settings.mode){var n=this;n.lock=function(){var t=n.lock;return function(){var e=n.$control.data("sortable");return e&&e.disable(),t.apply(n,arguments)}}(),n.unlock=function(){var t=n.unlock;return function(){var e=n.$control.data("sortable");return e&&e.enable(),t.apply(n,arguments)}}(),n.setup=function(){var e=n.setup;return function(){e.apply(this,arguments);var i=n.$control.sortable({items:"[data-value]",forcePlaceholderSize:!0,disabled:n.isLocked,start:function(t,e){e.placeholder.css("width",e.helper.css("width")),i.css({overflow:"visible"})},stop:function(){i.css({overflow:"hidden"});var e=n.$activeItems?n.$activeItems.slice():null,r=[];i.children("[data-value]").each(function(){r.push(t(this).attr("data-value"))}),n.setValue(r),n.setActiveItem(e)}})}}()}}),C.define("dropdown_header",function(e){var n=this;e=t.extend({title:"Untitled",headerClass:"selectize-dropdown-header",titleRowClass:"selectize-dropdown-header-title",labelClass:"selectize-dropdown-header-label",closeClass:"selectize-dropdown-header-close",html:function(t){return'<div class="'+t.headerClass+'"><div class="'+t.titleRowClass+'"><span class="'+t.labelClass+'">'+t.title+'</span><a href="javascript:void(0)" class="'+t.closeClass+'">&times;</a></div></div>'}},e),n.setup=function(){var i=n.setup;return function(){i.apply(n,arguments),n.$dropdown_header=t(e.html(e)),n.$dropdown.prepend(n.$dropdown_header)}}()}),C.define("optgroup_columns",function(e){var n=this;e=t.extend({equalizeWidth:!0,equalizeHeight:!0},e),this.getAdjacentOption=function(e,n){var i=e.closest("[data-group]").find("[data-selectable]"),r=i.index(e)+n;return r>=0&&r<i.length?i.eq(r):t()},this.onKeyDown=function(){var t=n.onKeyDown;return function(e){var i,r,o,s;return!this.isOpen||37!==e.keyCode&&39!==e.keyCode?t.apply(this,arguments):(n.ignoreHover=!0,s=this.$activeOption.closest("[data-group]"),i=s.find("[data-selectable]").index(this.$activeOption),s=37===e.keyCode?s.prev("[data-group]"):s.next("[data-group]"),o=s.find("[data-selectable]"),r=o.eq(Math.min(o.length-1,i)),void(r.length&&this.setActiveOption(r)))}}();var i=function(){var t,e=i.width,n=document;return void 0===e&&(t=n.createElement("div"),t.innerHTML='<div style="width:50px;height:50px;position:absolute;left:-50px;top:-50px;overflow:auto;"><div style="width:1px;height:100px;"></div></div>',t=t.firstChild,n.body.appendChild(t),e=i.width=t.offsetWidth-t.clientWidth,n.body.removeChild(t)),e},r=function(){var r,o,s,l,a,c,u;if(u=t("[data-group]",n.$dropdown_content),(o=u.length)&&n.$dropdown_content.width()){if(e.equalizeHeight){for(s=0,r=0;r<o;r++)s=Math.max(s,u.eq(r).height());u.css({height:s})}e.equalizeWidth&&(c=n.$dropdown_content.innerWidth()-i(),l=Math.round(c/o),u.css({width:l}),o>1&&(a=c-l*(o-1),u.eq(o-1).css({width:a})))}};(e.equalizeHeight||e.equalizeWidth)&&(d.after(this,"positionDropdown",r),d.after(this,"refreshOptions",r))}),C.define("remove_button",function(e){e=t.extend({label:"&times;",title:"Remove",className:"remove",append:!0},e);return"single"===this.settings.mode?void function(e,n){n.className="remove-single";var i=e,r='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+p(n.title)+'">'+n.label+"</a>",o=function(t,e){return t+e};e.setup=function(){var s=i.setup;return function(){if(n.append){var l=t(i.$input.context).attr("id"),a=(t("#"+l),i.settings.render.item);i.settings.render.item=function(t){return o(a.apply(e,arguments),r)}}s.apply(e,arguments),e.$control.on("click","."+n.className,function(t){t.preventDefault(),i.isLocked||i.clear()})}}()}(this,e):void function(e,n){var i=e,r='<a href="javascript:void(0)" class="'+n.className+'" tabindex="-1" title="'+p(n.title)+'">'+n.label+"</a>",o=function(t,e){var n=t.search(/(<\/[^>]+>\s*)$/);return t.substring(0,n)+e+t.substring(n)};e.setup=function(){var s=i.setup;return function(){if(n.append){var l=i.settings.render.item;i.settings.render.item=function(t){return o(l.apply(e,arguments),r)}}s.apply(e,arguments),e.$control.on("click","."+n.className,function(e){if(e.preventDefault(),!i.isLocked){var n=t(e.currentTarget).parent();i.setActiveItem(n),i.deleteSelection()&&i.setCaret(i.items.length)}})}}()}(this,e)}),C.define("restore_on_backspace",function(t){var e=this;t.text=t.text||function(t){return t[this.settings.labelField]},this.onKeyDown=function(){var n=e.onKeyDown;return function(e){var i,r;return 8===e.keyCode&&""===this.$control_input.val()&&!this.$activeItems.length&&(i=this.caretPos-1)>=0&&i<this.items.length?(r=this.options[this.items[i]],this.deleteSelection(e)&&(this.setTextboxValue(t.text.apply(this,[r])),this.refreshOptions(!0)),void e.preventDefault()):n.apply(this,arguments)}}()}),C});
